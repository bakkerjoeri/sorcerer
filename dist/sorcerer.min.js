!function(e){function t(n){if(i[n])return i[n].exports;var r=i[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var i={};t.m=e,t.c=i,t.d=function(e,i,n){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t(t.s=4)}([function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(this,e),t.hasOwnProperty("sprite")&&this.setSprite(t.sprite),t.hasOwnProperty("position")&&this.setPosition(t.position),t.hasOwnProperty("solid")&&this.setSolidity(t.solid),t.hasOwnProperty("boundaries")&&this.setBoundaries(t.boundaries),this.context=t.context}return r(e,[{key:"step",value:function(e){}},{key:"setSprite",value:function(e){this.sprite=e}},{key:"setPosition",value:function(e){this.position=e}},{key:"getPosition",value:function(){return this.position}},{key:"setSolidity",value:function(e){this.solid=e}},{key:"isSolid",value:function(){return this.solid}},{key:"setBoundaries",value:function(e){this.boundaries=e}},{key:"getBoundaries",value:function(){return this.boundaries}},{key:"changePosition",value:function(e){var t=this.getPosition();this.setPosition({x:t.x+e.x,y:t.y+e.y})}},{key:"isWithinBoundaries",value:function(e){return this.position.y<e.y+e.height&&this.position.x+this.boundaries.width>e.x&&this.position.y+this.boundaries.height>e.y&&this.position.x<e.x+e.width}}]),e}();t.default=o},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){var t=[];if(e.hasOwnProperty("file")){var i=new Image;i.src=e.file,e.frames.forEach(function(e){var n=new h.default(e.name,i,e.origin,e.size);t.push(n)})}return t}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=i(8),u=n(a),c=i(2),h=n(c),l=function(){function e(t){r(this,e),this.frames=o(t)}return s(e,[{key:"getFrame",value:function(e){return this.frames.find(function(t){return t.getName()===e})}},{key:"createSpriteWithFrames",value:function(e){var t=this,i=e.map(function(e){return t.getFrame(e)});return new u.default(i)}}]),e}();t.default=l},function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=function(){function e(t,i,r,o){n(this,e),this.setName(t),this.setImage(i),this.setOrigin(r),this.setSize(o)}return r(e,[{key:"setName",value:function(e){this.name=e}},{key:"setImage",value:function(e){var t=this;this.imageLoaded=!1,this.image=e,this.image.addEventListener("load",function(){t.imageLoaded=!0})}},{key:"setOrigin",value:function(e){this.origin=e}},{key:"setSize",value:function(e){this.size=e}},{key:"getName",value:function(){return this.name}},{key:"getImage",value:function(){return this.image}},{key:"getOrigin",value:function(){return this.origin}},{key:"getSize",value:function(){return this.size}},{key:"onImageLoaded",value:function(e){this.imageLoaded?e():this.image.addEventListener("load",e)}}]),e}();t.default=o},function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=new Map,s=function(){function e(){n(this,e)}return r(e,null,[{key:"subscribe",value:function(e,t){o.has(e)||o.set(e,[]),o.get(e).push(t)}},{key:"publish",value:function(e,t){o.has(e)&&o.get(e).forEach(function(e){e(t)})}}]),e}();t.default=s},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var r=i(5),o=n(r),s=i(6),a=n(s),u=i(7),c=n(u),h=i(9),l=n(h),f=i(10),d=n(f);i(11);var y=document.querySelector(".canvas__sorcerer"),p=new o.default({width:1e3,height:500}),v=new a.default(y,{x:0,y:0},{width:240,height:160});p.setBackgroundColor("#000"),p.addEntity(new c.default({position:{x:16,y:16}})),p.addEntity(new l.default({position:{x:144,y:64}})),p.addEntity(new d.default({position:{x:48,y:32}})),p.addEntity(new d.default({position:{x:64,y:32}})),p.addEntity(new d.default({position:{x:64,y:48}})),v.showRoom(p)},function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=function(){function e(t){n(this,e),this.setSize(t),this.entities=new Set}return r(e,[{key:"addEntity",value:function(e){this.entities.add(e),e.room=this}},{key:"getEntities",value:function(){return this.entities}},{key:"setSize",value:function(e){this.size=e}},{key:"getSize",value:function(){return this.size}},{key:"setBackgroundColor",value:function(e){this.backgroundColor=e}},{key:"getBackgroundColor",value:function(){return this.backgroundColor}},{key:"drawBackground",value:function(e){e.fillStyle=this.backgroundColor,e.fillRect(0,0,this.size.width,this.size.height)}},{key:"hasSolidEntityInBoundaries",value:function(e){return this.findSolidEntitiesInBoundaries(e).length>0}},{key:"findSolidEntitiesInBoundaries",value:function(e){var t=[];return this.entities.forEach(function(i){i.solid&&i.isWithinBoundaries(e)&&t.push(i)}),t}}]),e}();t.default=o},function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){e.width=t.width,e.height=t.height}function o(e,t){return{x:e.x-t.position.x,y:e.y-t.position.y}}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=function(){function e(t,i,r){n(this,e),this.useCanvas(t),this.position=i,this.setSize(r),this.startUpdating()}return s(e,[{key:"showRoom",value:function(e){this.room=e}},{key:"useCanvas",value:function(e){this.canvas=e,this.context=e.getContext("2d"),this.size&&r(e,this.size)}},{key:"setSize",value:function(e){this.size=e,this.canvas&&r(this.canvas,e)}},{key:"startUpdating",value:function(){window.requestAnimationFrame(this.update.bind(this))}},{key:"update",value:function(e){this.step(e),this.draw(e),window.requestAnimationFrame(this.update.bind(this))}},{key:"step",value:function(e){this.room.entities.forEach(function(t){t.step(e),t.sprite.step(e)})}},{key:"draw",value:function(e){var t=this;this.clearDrawing(this.context),this.room.drawBackground(this.context),this.room.entities.forEach(function(e){e.sprite.draw(t.context,o({x:e.position.x,y:e.position.y},t))})}},{key:"clearDrawing",value:function(e){e.clearRect(0,0,this.size.width,this.size.height)}}]),e}();t.default=a},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=i(0),c=n(u),h=i(1),l=n(h),f=i(3),d=n(f),y=function(e){function t(e){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),n=new l.default(JSON.parse('{ "file": "assets/images/character-sheet.png", "frames": [ { "name": "player_idle_0", "origin": { "x": 0, "y": 0 }, "size": { "width": 16, "height": 16 } }, { "name": "player_idle_1", "origin": { "x": 16, "y": 0 }, "size": { "width": 16, "height": 16 } }, { "name": "player_idle_2", "origin": { "x": 32, "y": 0 }, "size": { "width": 16, "height": 16 } }, { "name": "player_idle_3", "origin": { "x": 48, "y": 0 }, "size": { "width": 16, "height": 16 } }, {"name": "player_idle_4", "origin": { "x": 64, "y": 0 }, "size": { "width": 16, "height": 16 } }, { "name": "player_idle_5", "origin": { "x": 80, "y": 0 }, "size": { "width": 16, "height": 16 } } ] }')),s=n.createSpriteWithFrames(["player_idle_0","player_idle_0","player_idle_0","player_idle_0","player_idle_0","player_idle_1","player_idle_2","player_idle_3","player_idle_3","player_idle_3","player_idle_3","player_idle_4","player_idle_5"]);return s.setFramesPerSecond(10),i.setSprite(s),i.setBoundaries({width:16,height:16}),i.setSolidity(!0),window.addEventListener("keydown",i.onKeyDown.bind(i)),i}return s(t,e),a(t,[{key:"onKeyDown",value:function(e){"ArrowUp"===e.key&&(e.preventDefault(),this.moveUp()),"ArrowRight"===e.key&&(e.preventDefault(),this.moveRight()),"ArrowDown"===e.key&&(e.preventDefault(),this.moveDown()),"ArrowLeft"===e.key&&(e.preventDefault(),this.moveLeft())}},{key:"moveUp",value:function(){this.canMoveToPosition({x:this.position.x,y:this.position.y-16})&&(this.changePosition({x:0,y:-16}),d.default.publish("turnTaken",{direction:"up"}))}},{key:"moveRight",value:function(){this.canMoveToPosition({x:this.position.x+16,y:this.position.y})&&(this.changePosition({x:16,y:0}),d.default.publish("turnTaken",{direction:"right"}))}},{key:"moveDown",value:function(){this.canMoveToPosition({x:this.position.x,y:this.position.y+16})&&(this.changePosition({x:0,y:16}),d.default.publish("turnTaken",{direction:"down"}))}},{key:"moveLeft",value:function(){this.canMoveToPosition({x:this.position.x-16,y:this.position.y})&&(this.changePosition({x:-16,y:0}),d.default.publish("turnTaken",{direction:"left"}))}},{key:"canMoveToPosition",value:function(e){return!this.room.hasSolidEntityInBoundaries({x:e.x,y:e.y,width:this.sprite.size.width,height:this.sprite.size.height})}}]),t}(c.default);t.default=y},function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t,i){if(0===(t=Math.round(t)))return e;var n=(e+t)%i;return n<0?n+i:n}function o(e){var t=0,i=0;return e.forEach(function(e){e.size.width>t&&(t=e.size.width),e.size.height>i&&(i=e.size.height)}),{width:t,height:i}}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=i(2),u=function(e){return e&&e.__esModule?e:{default:e}}(a),c=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n(this,e),this.setFrames(t),i.hasOwnProperty("size")?this.size=i.size:this.size=o(this.getFrames()),i.hasOwnProperty("origin")&&(this.origin=i.origin),i.hasOwnProperty("frameIndex")?this.setCurrentFrameIndex(i.frameIndex):this.setCurrentFrameIndex(0),i.hasOwnProperty("framesPerSecond")?this.setFramesPerSecond(i.framesPerSecond):this.setFramesPerSecond(1),this.timeOfPreviousFrame=0}return s(e,[{key:"setFrames",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Array.isArray(e)?this.frames=e:e instanceof u.default?this.frames=[e]:this.frames=[]}},{key:"getFrames",value:function(){return this.frames}},{key:"setFramesPerSecond",value:function(e){this.framesPerSecond=e}},{key:"getFramesPerSecond",value:function(){return this.framesPerSecond}},{key:"setCurrentFrameIndex",value:function(e){this.frames[e]&&(this.currentFrameIndex=e)}},{key:"getCurrentFrame",value:function(){return this.frames[this.currentFrameIndex]}},{key:"draw",value:function(e,t){var i=this.getCurrentFrame();i&&e.drawImage(i.getImage(),i.getOrigin().x,i.getOrigin().y,i.getSize().width,i.getSize().height,t.x,t.y,this.size.width,this.size.height)}},{key:"step",value:function(e){var t=this.getFramesPerSecond();if(0!==t){var i=e-this.timeOfPreviousFrame,n=i/(1e3/t);n>0&&(n=Math.floor(n)),n<0&&(n=Math.ceil(n)),0!==n&&(this.timeOfPreviousFrame=e,this.setCurrentFrameIndex(r(this.currentFrameIndex,n,this.frames.length)))}}},{key:"nextFrame",value:function(){this.currentFrameIndex=r(this.currentFrameIndex,1,this.frames.length)}},{key:"previousFrame",value:function(){this.currentFrameIndex=r(this.currentFrameIndex,-1,this.frames.length)}}]),e}();t.default=c},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=i(0),c=n(u),h=i(1),l=n(h),f=i(3),d=n(f),y=function(e){function t(e){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),n=new l.default(JSON.parse('{ "file": "assets/images/slime-sheet.png", "frames": [ { "name": "slime_idle_0", "origin": { "x": 0, "y": 0 }, "size": { "width": 16, "height": 16 } }, { "name": "slime_idle_1", "origin": { "x": 16, "y": 0 }, "size": { "width": 16, "height": 16 } } ] }')),s=n.createSpriteWithFrames(["slime_idle_0","slime_idle_1"]);return s.setFramesPerSecond(2),i.setSprite(s),i.setBoundaries({width:16,height:16}),i.setSolidity(!0),d.default.subscribe("turnTaken",i.takeTurn.bind(i)),i}return s(t,e),a(t,[{key:"takeTurn",value:function(e){var t=Math.round(11*Math.random());0===t&&this.moveUp(),1===t&&this.moveRight(),2===t&&this.moveDown(),3===t&&this.moveLeft()}},{key:"moveUp",value:function(){this.canMoveToPosition({x:this.position.x,y:this.position.y-16})&&this.changePosition({x:0,y:-16})}},{key:"moveRight",value:function(){this.canMoveToPosition({x:this.position.x+16,y:this.position.y})&&this.changePosition({x:16,y:0})}},{key:"moveDown",value:function(){this.canMoveToPosition({x:this.position.x,y:this.position.y+16})&&this.changePosition({x:0,y:16})}},{key:"moveLeft",value:function(){this.canMoveToPosition({x:this.position.x-16,y:this.position.y})&&this.changePosition({x:-16,y:0})}},{key:"canMoveToPosition",value:function(e){return!this.room.hasSolidEntityInBoundaries({x:e.x,y:e.y,width:this.sprite.size.width,height:this.sprite.size.height})}}]),t}(c.default);t.default=y},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=i(0),u=n(a),c=i(1),h=n(c),l=function(e){function t(e){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),n=new h.default(JSON.parse('{ "file": "assets/images/wall-sheet.png", "frames": [ { "name": "wall_0", "origin": { "x": 0, "y": 0 }, "size": { "width": 16, "height": 16 } } ] }')),s=n.createSpriteWithFrames(["wall_0"]);return i.setSprite(s),i.setBoundaries({width:16,height:16}),i.setSolidity(!0),i}return s(t,e),t}(u.default);t.default=l},function(e,t){}]);
//# sourceMappingURL=sorcerer.min.js.map